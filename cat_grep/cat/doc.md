# Документация к директории **[`cat`](.)**

## [CAT](.)

### Опции cat

| № | Опции | Описание |
| ------ | ------ | ------ |
| 1 | -b (GNU: --number-nonblank) | нумерует только непустые строки |
| 2 | -e предполагает и -v (GNU only: -E то же самое, но без применения -v) | также отображает символы конца строки как $  |
| 3 | -n (GNU: --number) | нумерует все выходные строки |
| 4 | -s (GNU: --squeeze-blank) | сжимает несколько смежных пустых строк |
| 5 | -t предполагает и -v (GNU: -T то же самое, но без применения -v) | также отображает табы как ^I |

### [s21_cat.h](s21_cat.h)

```C
// Определение флагов для опций
#define FLAG_B 0x01 // Нумерация только непустых строк
#define FLAG_E 0x02 // Отображение символа конца строки как $
#define FLAG_N 0x04 // Нумерация всех строк
#define FLAG_S 0x08 // Сжатие смежных пустых строк
#define FLAG_T 0x10 // Отображение табов как ^I
```

Каждый флаг представляет собой уникальный бит в целом числе. Нужно для комбинации флагов с помощью битовых операций. (16CC)

---

### [s21_cat.c](s21_cat.c)

#### `void parse_options(int argc, char * argv[], int * flags)`

```C
// Функция для парсинга опций командной строки
void parse_options(int argc, char *argv[], int *flags)
{
    // Определение длинных опций
    static struct option long_options[] = {
        {"number-nonblank", no_argument, 0, 'b'}, // Нумерация только непустых строк
        {"number", no_argument, 0, 'n'},          // Нумерация всех строк
        {"squeeze-blank", no_argument, 0, 's'},   // Сжатие смежных пустых строк
        {0, 0, 0, 0}};

    int flag;

    while ((flag = getopt_long(argc, argv, "benstET", long_options, NULL)) != -1)
    {
        switch (flag)
        {
        case 'b':
            *flags |= FLAG_B; // Установка флага нумерации только непустых строк
            break;
        case 'e':
            *flags |= FLAG_E; // Установка флага отображения символа конца строки как $
            break;
        case 'n':
            *flags |= FLAG_N; // Установка флага нумерации всех строк
            break;
        case 's':
            *flags |= FLAG_S; // Установка флага сжатия смежных пустых строк
            break;
        case 't':
            *flags |= FLAG_T; // Установка флага отображения табов как ^I
            break;
        case 'E':
            *flags |= FLAG_E; // Установка флага отображения символа конца строки как $
            break;
        case 'T':
            *flags |= FLAG_T; // Установка флага отображения табов как ^I
            break;
        default:
            fprintf(stderr, "Usage: %s [-benst] [file...]\n", argv[0]);
            exit(EXIT_FAILURE);
        }
    }
}
```

---

#### `struct option`

```C
struct option {
    const char *name;     // Имя длинной опции
    int         has_arg;  // Флаг, указывающий, требуется ли аргумент для этой опции
    int        *flag;     // Указатель на переменную, в которую будет записано значение, если flag не равен NULL
    int         val;      // Значение, которое будет возвращено или записано в *flag
};
```

```C
static struct option long_options[] = {
    {"number-nonblank", no_argument, 0, 'b'},
    {"number", no_argument, 0, 'n'},
    {"squeeze-blank", no_argument, 0, 's'},
    {0, 0, 0, 0}};
```

- **name**: Имя длинной опции. `"number-nonblank"`.
- **has_arg**: Флаг, указывающий, требуется ли аргумент для этой опции. Возможные значения:
  - `no_argument` (или 0): Опция не требует аргумента.
  - `required_argument` (или 1): Опция требует обязательного аргумента.
  - `optional_argument` (или 2): Опция может иметь необязательный аргумент.
- **flag**: Указатель на переменную, в которую будет записано значение, если `flag` не равен `NULL`. Если `flag` равен `NULL`, то функция вернет значение `val`.
- **val**: Значение, которое будет возвращено или записано в `*flag`.

`{0, 0, 0, 0}`: Завершающий элемент, указывающий на конец массива опций.

---

#### `getopt_long`

```C
int getopt_long(int argc, char *const argv[], const char *shortopts, const struct option *longopts, int *longindex);
```

- **argc**: Количество аргументов, переданных в `main`.
- **argv**: Массив аргументов, переданных в `main`.
- **shortopts**: Строка, содержащая короткие опции. Например, `"benstET"`.
- **longopts**: Массив структур `struct option`, описывающих длинные опции.
- **longindex**: Указатель на переменную, в которую будет записан индекс найденной длинной опции. Если не нужен, можно передать `NULL`.

---

Битовая операция |=
Оператор |= (битовое ИЛИ с присваиванием) используется для установки определенного бита в переменной flags.

---
